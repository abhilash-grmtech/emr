Based on reference implementation: weigth
